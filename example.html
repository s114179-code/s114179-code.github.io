<!IDOCTYPE HTML>
<html>
  <head>
    <meta charset="utf-8">
    <title>å®œè•™çš„ç¶²ç«™</title>
    <link rel="icon" href="5bbe86970d244a4fbe3713c16f8c6e6c.jpeg">
   
  <meta charset="utf-8" />
  <title>Flappy Bird</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    :root { --bg:#70c5ce; --ground:#ded895; --pipe:#2d8a3a; --bird:#ffdd57; }
    html,body{height:100%;margin:0;font-family:Helvetica,Arial,sans-serif;background:var(--bg);display:flex;align-items:center;justify-content:center;}
    .wrap{width:360px; max-width:95vw; text-align:center;}
    canvas{display:block;margin:16px auto;border-radius:8px;box-shadow:0 6px 18px rgba(0,0,0,0.2); background:linear-gradient(#70c5ce,#6fc2ca);}
    .hud{color:#fff;font-weight:700;text-shadow:0 1px 0 rgba(0,0,0,0.2);}
    .hint{color:#fff;font-weight:600;margin-top:8px;}
    .credits{font-size:12px;color:rgba(255,255,255,0.9);margin-top:6px;}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="hud">
      <h2 style="margin:6px 0;">Flappy Bird â€” é«˜åˆ†ç‰ˆ</h2>
    </div>

    <canvas id="game" width="360" height="600"></canvas>

    <div class="hint">æŒ‰ ç©ºç™½éµ / æ»‘é¼  / æ‰‹æ©Ÿ é»æ“Š æ§åˆ¶è·³èº</div>
    <div class="credits">å­˜æˆ index.html ç›´æ¥ç©ï¼</div>
  </div>

  <script>
    const canvas = document.getElementById('game');
    const ctx = canvas.getContext('2d');

    const GRAVITY = 0.9;
    const FLAP = -12;

    let bird, pipes, frameCount, score, state;

    // â­ æœ€é«˜ç´€éŒ„ï¼ˆè®€å– localStorageï¼‰
    let highScore = Number(localStorage.getItem("flappy_highscore")) || 0;

    function reset() {
      bird = {
        x: 80,
        y: canvas.height/2 - 20,
        w: 34,
        h: 24,
        vy: 0,
        rotation: 0
      };
      pipes = [];
      frameCount = 0;
      score = 0;
      state = 'ready';
    }

    function spawnPipe() {
      const gap = 140;
      const top = 50 + Math.random() * (canvas.height - 220);
      pipes.push({
        x: canvas.width + 10,
        w: 54,
        topHeight: top,
        bottomHeight: canvas.height - top - gap,
        passed: false
      });
    }

    function collides(b, p) {
      if (b.x + b.w > p.x && b.x < p.x + p.w) {
        if (b.y < p.topHeight || b.y + b.h > canvas.height - p.bottomHeight) return true;
      }
      if (b.y + b.h >= canvas.height || b.y <= 0) return true;
      return false;
    }

    function draw() {
      const g = ctx.createLinearGradient(0,0,0,canvas.height);
      g.addColorStop(0, '#70c5ce');
      g.addColorStop(1, '#6fc2ca');
      ctx.fillStyle = g;
      ctx.fillRect(0,0,canvas.width,canvas.height);

      ctx.fillStyle = '#2d8a3a';
      pipes.forEach(p => {
        ctx.fillRect(p.x, 0, p.w, p.topHeight);
        ctx.fillRect(p.x, canvas.height - p.bottomHeight, p.w, p.bottomHeight);
      });

      ctx.save();
      ctx.translate(bird.x + bird.w/2, bird.y + bird.h/2);
      ctx.rotate(bird.rotation);
      ctx.fillStyle = '#ffdd57';
      ctx.fillRect(-bird.w/2, -bird.h/2, bird.w, bird.h);
      ctx.fillStyle = '#333';
      ctx.fillRect(bird.w/8, -4, 6, 6);
      ctx.restore();

      // ğŸŸ¡ é¡¯ç¤ºåˆ†æ•¸
      ctx.fillStyle = '#fff';
      ctx.font = '26px Arial';
      ctx.textAlign = 'left';
      ctx.fillText('Score: ' + score, 12, 36);

      // â­ é¡¯ç¤ºæœ€é«˜åˆ†
      ctx.fillText('High: ' + highScore, 12, 70);

      if (state === 'ready') {
        ctx.fillStyle = 'rgba(0,0,0,0.6)';
        ctx.font = '22px Arial';
        ctx.textAlign = 'center';
        ctx.fillText('é»æ“Šæˆ–æŒ‰ç©ºç™½éµé–‹å§‹', canvas.width/2, canvas.height/2 - 20);
      } else if (state === 'gameover') {
        ctx.fillStyle = 'rgba(255,0,0,0.95)';
        ctx.font = '44px Arial';
        ctx.textAlign = 'center';
        ctx.fillText('Game Over', canvas.width/2, canvas.height/2 - 20);

        ctx.fillStyle = '#fff';
        ctx.font = '20px Arial';
        ctx.fillText('é»æ“Šæˆ–æŒ‰ç©ºç™½éµé‡æ–°é–‹å§‹', canvas.width/2, canvas.height/2 + 20);

        ctx.font = '18px Arial';
        ctx.fillText('æœ€çµ‚åˆ†æ•¸: ' + score, canvas.width/2, canvas.height/2 + 56);

        // â­ é¡¯ç¤ºæœ€é«˜åˆ†
        ctx.fillText('æœ€é«˜ç´€éŒ„: ' + highScore, canvas.width/2, canvas.height/2 + 84);
      }
    }

    function update() {
      if (state === 'playing') {
        bird.vy += GRAVITY;
        bird.y += bird.vy;
        bird.rotation = Math.max(-0.6, Math.min(1.2, bird.vy * 0.03));

        if (frameCount % 110 === 0) spawnPipe();

        for (let p of pipes) {
          p.x -= 2.6;

          if (!p.passed && (p.x + p.w) < bird.x) {
            score++;
            p.passed = true;
          }

          if (collides(bird, p)) {
            // â­ æ›´æ–°æœ€é«˜ç´€éŒ„
            if (score > highScore) {
              highScore = score;
              localStorage.setItem("flappy_highscore", highScore);
            }
            state = 'gameover';
          }
        }

        pipes = pipes.filter(p => p.x + p.w > -10);
      }

      frameCount++;
    }

    function loop() {
      update();
      draw();
      requestAnimationFrame(loop);
    }

    function flap() {
      if (state === 'ready') {
        state = 'playing';
        bird.vy = FLAP;
      } else if (state === 'playing') {
        bird.vy = FLAP;
      } else if (state === 'gameover') {
        reset();
      }
    }

    window.addEventListener('keydown', (e) => {
      if (e.code === 'Space') {
        e.preventDefault();
        flap();
      }
    });

    canvas.addEventListener('mousedown', flap);
    canvas.addEventListener('touchstart', (e) => { e.preventDefault(); flap(); }, {passive:false});

    reset();
    loop();
  </script>
</body>
</html>
